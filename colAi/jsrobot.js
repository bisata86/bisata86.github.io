function changeGridDim(){$(window).width()>$(window).height()?($("body").addClass("landscape"),$("body").removeClass("portrait")):($("body").removeClass("landscape"),$("body").addClass("portrait"))}$(document).ready(function(){ga("create","UA-56086246-1","auto"),ga("send","pageview"),changeGridDim()}),window.fbAsyncInit=function(){FB.init({appId:"866370050124335",xfbml:!0,version:"v2.4"})},function(e,t,n){var a,o=e.getElementsByTagName(t)[0];e.getElementById(n)||(a=e.createElement(t),a.id=n,a.src="//connect.facebook.net/en_US/sdk.js",o.parentNode.insertBefore(a,o))}(document,"script","facebook-jssdk"),$(window).on("orientationchange",function(){changeGridDim()}),$(function(){function e(e){"win"==e&&k++,m()?("win"==e&&(b+=3),$("body").addClass("mobile"),y="touchstart"):($("body").addClass("desktop"),y="click","win"==e&&(b+=5)),x=100/b+"%",A=[],O=[],D="<div class='pixel'></div>",M="";for(var t=0;b>t;t++)for(var n=0;b>n;n++)M+=D;$("#grid").html(""),$("#grid").append(M),v(),d(),g(),changeGridDim(),s(),$("body").removeClass("gameover"),changeGridDim(),$("body").addClass("gaming"),$("#levelcounter").html(""+k),A.push(C[0][b-1]),O.push(C[b-1][0]),$(".power").removeClass("mine").removeClass("disabled")}function t(){var e,t=Math.floor(6*Math.random()+1);return 1==t&&(e="green"),2==t&&(e="yellow"),3==t&&(e="red"),4==t&&(e="blue"),5==t&&(e="violet"),6==t&&(e="orange"),e}function n(e){$("#powers").removeClass("wait"),$(".power").removeClass("disabled"),$("#"+e[0][0]).attr("class","power disabled");var n,r=0;if($(".power").each(function(){if($(this).attr("id")!=A[0][0]){var t=a(e,$(this).attr("id"));r<t[0]&&(r=t[0],n=t[1])}}),void 0!=n)for(var l=0;l<e.length;l++)e[l][0]=n,C[e[l][1]][e[l][2]][0]=n;else{for(var d=t();d==A[0][0];)d=t();for(var l=0;l<e.length;l++)e[l][0]=d,C[e[l][1]][e[l][2]][0]=d}$(".power").removeClass("disabled"),$("#"+e[0][0]).attr("class","power disabled"),o(e,"ai"),A.length>Math.floor(C.length*C.length/2)?(i("WIN <br>"+A.length+":"+e.length,"win"),$("body").addClass("gameover"),$("body").removeClass("gaming")):e.length>Math.floor(C.length*C.length/2)?(i("LOOSE <br>"+A.length+":"+e.length,"reload"),$("body").addClass("gameover"),$("body").removeClass("gaming")):A.length+e.length==C.length*C.length&&(A.length>e.length?i("WIN <br>"+A.length+":"+e.length,"win"):A.length<e.length?i("LOOSE <br>"+A.length+":"+e.length,"reload"):i("DRAW <br>"+A.length+":"+e.length,"draw"),$("body").addClass("gameover"),$("body").removeClass("gaming"));for(var l=0;l<e.length;l++){var g=f(e[l][1],e[l][2]);h(g,e[l][1],e[l][2])}setTimeout(function(){for(var t=0;t<e.length;t++){var n=f(e[t][1],e[t][2]);c(n,e[t][1],e[t][2])}},300),s()}function a(e,t){for(var n=[],a=t,o=0;o<e.length;o++)e[o][2]<b-1&&C[e[o][1]][e[o][2]+1][0]==a&&-1==e.indexOf(C[e[o][1]][e[o][2]+1])&&n.push(C[e[o][1]][e[o][2]+1]),e[o][2]>0&&C[e[o][1]][e[o][2]-1][0]==a&&-1==e.indexOf(C[e[o][1]][e[o][2]-1])&&n.push(C[e[o][1]][e[o][2]-1]),e[o][1]>0&&C[e[o][1]-1][e[o][2]][0]==a&&-1==e.indexOf(C[e[o][1]-1][e[o][2]])&&n.push(C[e[o][1]-1][e[o][2]]),e[o][1]<b-1&&C[e[o][1]+1][e[o][2]][0]==a&&-1==e.indexOf(C[e[o][1]+1][e[o][2]])&&n.push(C[e[o][1]+1][e[o][2]]);return[n.length,t]}function o(e){for(var t=e[0][0],n=0;n<e.length;n++)e[n][2]<b-1&&C[e[n][1]][e[n][2]+1][0]==t&&-1==e.indexOf(C[e[n][1]][e[n][2]+1])&&e.push(C[e[n][1]][e[n][2]+1]),e[n][2]>0&&C[e[n][1]][e[n][2]-1][0]==t&&-1==e.indexOf(C[e[n][1]][e[n][2]-1])&&e.push(C[e[n][1]][e[n][2]-1]),e[n][1]>0&&C[e[n][1]-1][e[n][2]][0]==t&&-1==e.indexOf(C[e[n][1]-1][e[n][2]])&&e.push(C[e[n][1]-1][e[n][2]]),e[n][1]<b-1&&C[e[n][1]+1][e[n][2]][0]==t&&-1==e.indexOf(C[e[n][1]+1][e[n][2]])&&e.push(C[e[n][1]+1][e[n][2]])}function r(){p=setInterval(function(){changeGridDim()},3e3)}function i(t,n){$(".clickcounter").html(t),$(".clickcounter").show(),setTimeout(function(){$(".clickcounter").fadeOut(),"reload"==n&&(console.log(G),window.location.reload()),"win"==n&&(G+=Math.ceil(2*k),e("win")),"draw"==n&&e("same")},2e3)}function l(e){$("body").addClass("pauseGrid"),$(".clickcounter").html(e),$(".clickcounter").show(),setTimeout(function(){$(".clickcounter").fadeOut()},900),setTimeout(function(){$("body").removeClass("pauseGrid")},1300)}function s(){$("#youCounter").html(A.length),$("#aiCounter").html(O.length>1?O.length:"0")}function d(){for(var e=0;b>e;e++)for(var t=0;b>t;t++){var n=$(".pixel:eq("+f(e,t)+")");n.attr("class","pixel "+C[e][t][0])}$(".pixel:eq(0)").attr("class","pixel you"),$(".pixel:eq("+(b*b-1)+")").attr("class","pixel ai")}function c(e,t,n){var a=$(".pixel:eq("+e+")");a.attr("class","pixel "+C[t][n][0])}function h(e){var t=$(".pixel:eq("+e+")");t.attr("class","pixel black")}function g(){$(".pixel").each(function(){$(this).css({height:x,width:x})})}function u(e){return[e%b,b-1-parseInt(e/b)]}function f(e,t){var n=b*(b-1-t)+e;return n}function v(){b>=20&&$("#grid").addClass("small"),C=new Array(b);for(var e=0;b>e;e++)C[e]=new Array(b);for(var t=0;b>t;t++)for(var n=0;b>n;n++){var a=Math.floor(6*Math.random()+1);1==a&&(C[t][n]=["green",t,n]),2==a&&(C[t][n]=["yellow",t,n]),3==a&&(C[t][n]=["red",t,n]),4==a&&(C[t][n]=["blue",t,n]),5==a&&(C[t][n]=["orange",t,n]),6==a&&(C[t][n]=["violet",t,n])}}function m(){return navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)?!0:!1}setTimeout(function(){$("body").addClass("noFb")},1e4);var p,w=!0;r();var b,y;m()?(b=5,$("body").addClass("mobile"),y="touchstart"):($("body").addClass("desktop"),y="click",b=10);for(var C,x=100/b+"%",k=(Math.floor(b/2),Math.floor(b/2),1),A=[],O=[],G=0,D="<div class='pixel'></div>",M="",T=0;b>T;T++)for(var I=0;b>I;I++)M+=D;$("#grid").append(M),v(),d(),g(),changeGridDim(),s(),$("#start").click(function(){$("body").removeClass("infodisplayed"),changeGridDim(),$("body").addClass("gaming"),$("#levelcounter").html(""+k),A.push(C[0][b-1]),O.push(C[b-1][0])}),$(".pixel").on(y,function(){var e=$(this).prevAll("div").length,t=u(e);0==t[0]&&t[1]==b-1?l("You start from here!"):t[0]==b-1&&0==t[1]?l("Ai starts from here!"):(w=!w,l(w?"Click the circles to change color!":"Collect more tiles than Ai!"))}),$(".power").on(y,function(){$("#powers").addClass("wait"),$(".power").removeClass("mine"),$(this).attr("class","power mine");for(var e=0;e<A.length;e++)A[e][0]=$(this).attr("id"),C[A[e][1]][A[e][2]][0]=$(this).attr("id");o(A,"user");for(var e=0;e<A.length;e++){var t=f(A[e][1],A[e][2]);h(t,A[e][1],A[e][2])}setTimeout(function(){for(var e=0;e<A.length;e++){var t=f(A[e][1],A[e][2]);c(t,A[e][1],A[e][2])}},300),setTimeout(function(){n(O)},1e3),s()})});